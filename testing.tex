\section{Результаты апробации решения}

%TODO: описать, откуда взяты данные

\subsection{Порядок проведения апробации}

В ходе апробации полученного решения проводились следующие проверки:

\begin{itemize}
 \item проверка корректности работы анализатора - для заданной трассы и 
описания требований проверялось обнаружение несоответствий и отсутствие ложных 
срабатываний анализатора;
 \item проверка быстродействия анализатора для определения возможности работы в 
режиме регистрации обмена в реальном времени.
\end{itemize}

Для проведения апробации анализатора были использованы трассы обмена, 
полученные с помощью генератора, описание которого приведено в 
приложении~\ref{sec:test_listings}, а также трассы обмена, зарегистрированные 
в ходе работ на стендах тестирования бортового авиационного оборудования 
[\ref{stand3}].


\subsection{Конфигурация тестовой ЭВМ}
\label{subsec:test_stand}

\begin{itemize}
 \item Процессор: Intel Core i5-3320M, 2.6 ГГц;
 \item ОЗУ: 1024 МБ;
 \item ОС: Debian Linux 7 (wheezy), 32-разрядная;
 \item SSD. 
\end{itemize}

Тестирование решения проводилось на виртуальной ЭВМ в среде Oracle VM 
VirtualBox [\ref{virtualbox}].

\subsection{Проверка корректности работы анализатора}

Апробация возможностей анализатора проводилась на наборе требований, 
соответствующих трассам обменов, полученным с помощью генератора, описание 
которого приведено в приложении~\ref{sec:test_listings}.

\subsubsection{Пример 1}

В примере 1 наблюдается изменение значений младших 8 бит значений параметров 4 
и 6 из таблицы~\ref{tab:params} (назовём полученные параметры 4а и 6а 
соответственно). Значение параметра 4а 
постоянно и равно 42. Если для параметра 6а не выполнено условие генерации 
ошибки, его значение равно значению параметра 4а, иначе - константе 173 (0xAD). 

Параметры связываются в группу с идентификатором \textit{int42} со 
значениями погрешности по умолчанию (5\%). Поскольку параметр 6а принимает 
ошибочные значения со значительным отклонением (больше 5\%), в отчёте 
анализатора должны появиться сообщения о расхождении значений параметров в 
группе \textit{int42}.

График изменения значений параметров 
приводится на рисунке~\ref{fig:param_bind_graph}. Отчёт анализатора приводится 
на рисунке~\ref{fig:param_bind_report}.

\subsubsection{Пример 2}

В примере 2 наблюдается изменение значения параметра 6 из 
таблицы~\ref{tab:params}. Для проверки факта равенства параметра ошибочному 
значению 57005 (0xDEAD) используется ограничение error\_value.

График изменения значения параметра 
приводится на рисунке~\ref{fig:param_error_value_graph}. Отчёт анализатора 
приводится на рисунке~\ref{fig:param_error_value_report}.

\subsubsection{Пример 3}

В примере 3 наблюдается изменение значения параметра 6 из 
таблицы~\ref{tab:params}. Для обнаружения ``выбросов'' (значительных (>5\%)
отклонений значения параметра от исходной функции) используется ограничение 
smooth с максимальным значением производной по модулю, равным 1000 (значение 
подобрано эмпирически).

График изменения значения параметра 
приводится на рисунке~\ref{fig:param_smooth_graph}. Отчёт анализатора 
приводится на рисунке~\ref{fig:param_smooth_report}.

\subsection{Проверка быстродействия анализатора}

Для проведения проверки быстродействия анализатора был модифицирован генератор 
обменов, использованный для проведения предыдущих проверок. Целью модификации 
было получение большего числа типов сообщений.

Для проведения проверки записана трасса обменов с помощью  
модифицированного генератора длительностью 20 минут, содержащая $N_{exch} 
= 108873$ обмена. 

Файл протокола содержит описания всех сообщений, получаемых от 
модифицированного генератора (всего 250 типов сообщений). Количество типов 
сообщений выбрано в соответствии с таковым в изученных трассах обменов 
используемых РВС. Для каждого из типов сообщений описываются ограничения; 
количество ограничений для каждого из проведённых тестов приводится в 
таблице~\ref{tab:prof}.

Для типов сообщений, подразумевающих передачу полезной нагрузки, описаны также 
передаваемые параметры и ограничения для них. Количество параметров в протоколе 
и количество ограничений для каждого из параметров приведены в 
таблице~\ref{tab:prof}.

Проверка проводилась для разного количества описаний сообщений и 
параметров, а также разного количества ограничений на сообщения и параметры.

Проект собирался с выставленными флагами оптимизации (перед сборкой была 
создана глобальная переменная окружения CL\_OPTIMIZE=1, используемая системой 
сборки cvslvk [\ref{cvslvk}]).

Для каждого из описаний требований проводилась операция загрузки трассы. 
Операция проводилась 5 раз для каждого описания требований, после чего 
подсчитывалось среднее значение времени загрузки трассы и среднее значение 
времени, потраченного в контексте анализатора. \textit{Время в контексте 
анализатора} - время, потраченное в методах-обработчиках:
\begin{itemize}
 \item AnalyzerCore::onParamValueUpdated(),
 \item AnalyzerCore::onAddExchange(). 
\end{itemize}

Время загрузки трассы оценивается временем выполнения метода 

\begin{itemize}
 \item ExchangeContainer::addSubscriber().
\end{itemize}

Для 5 запусков решения среднеквадратичное отклонение результатов 
измерения оценки времени выполнения для обоих случаев не превысило 2.5\%.

Результаты проверки приведены в таблице~\ref{tab:prof}.

Легенда таблицы:

\begin{itemize}
 \item $N_{msgs}$ - общее число сообщений, описанных в файле протокола;
 \item $N_{params}$ - общее число параметров, описанных в файле протокола;
 \item $M_{msg}$ - количество ограничений на каждое из описанных сообщений;
 \item $M_{param}$ - количество ограничений на каждый из описанных параметров;
 \item $t_{total}$ - среднее значение оценки времени загрузки трассы с данным 
описанием протокола (в секундах);
 \item $t_{a}$ - среднее значение оценки времени, потраченного в контексте 
анализатора при загрузке трассы с данным описанием протокола (в секундах);
 \item $\%$ - доля времени, потраченного в контексте анализатора, по 
отношению к общему времени загрузки трассы (в процентах, для средних значений 
оценки времени).
\end{itemize}


\begin{table}[H]
 \centering
 \begin{tabular}{|c|*{7}{c|}}
  \hline
  № теста & $N_{msgs}$ & $N_{params}$ & $M_{msg}$ & $M_{param}$ & $t_{total}$, 
с & $t_{a}$, с & \% \\
  \hline
  1 & 128 & 128 & 5   & 5   & 3.610892 & 0.572862 & 15.86 \\
  2 & 128 & 240 & 5   & 5   & 5.470608 & 0.888364 & 16.23 \\
  3 & 240 & 128 & 5   & 5   & 3.517034 & 0.553243 & 15.73 \\
  4 & 240 & 240 & 5   & 5   & 5.459458 & 0.889838 & 16.29 \\
  5 & 128 & 128 & 10 & 10 & 4.250614 & 1.249704 & 29.4 \\
  \hline
 \end{tabular}
 \caption{Результаты проверки быстродействия решения}
 \label{tab:prof}
\end{table}

В самом худшем случае на анализ одного обмена (с учётом накладных расходов) в 
среднем приходится $\hat{t_{a}} = t_{total} / N_{exch} \approx 3.9 * 10^{-5}$ 
с. 

В ходе исследования были изучены трассы обменов на реальных распределённых 
системах. Используем данные, полученные при изучении одной из этих трасс, для 
оценки возможности использования анализатора при регистрации обменов в реальном 
времени.

Средняя длительность обмена в трассе обмена, записанной на реальной системе: 
$\hat{t_{ex}} \approx 3.6 * 10^{-4}$ c. При длительности записанной трассы 
$t_{T} = 50$ с и количестве зарегистрированных обменов $\hat{N_{exch}} = 28452$ 
получаем среднюю продолжительность паузы между обменами:

$$
\hat{p} = \frac{t_{T} - \hat{t_{ex}} * \hat{N_{exch}}}{\hat{N_{exch}} - 1} 
\approx 1.39 * 10^{-3} c,
$$

что значительно больше средней оценки времени анализа одного обмена, полученной 
в результате проверки быстродействия в худшем случае:

$$
\hat{p} = 1.39 * 10^{-3} > 3.9 * 10^{-5} = \hat{t_{a}}.
$$

Таким образом, проверка быстродействия показывает, что анализатор имеет
возможность выполняться при регистрации обменов в реальном времени.

\subsection{Результаты}

В процессе апробации было выяснено, что анализатор корректно обрабатывает 
ограничения, накладываемые на обмены и параметры в описании протокола. Также 
проверка быстродействия показала, что анализатор способен обрабатывать 
достаточно большое количество ограничений в режиме анализа записанной трассы 
и при регистрации обменов в реальном времени.